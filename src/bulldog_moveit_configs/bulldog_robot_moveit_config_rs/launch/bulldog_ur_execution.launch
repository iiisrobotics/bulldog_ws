<launch>
  <!-- GDB functionality -->
  <arg name="debug" default="false" />
  <arg unless="$(arg debug)" name="launch_prefix" value="" />
  <arg     if="$(arg debug)" name="launch_prefix" value="gdb --ex run --args" />

  <!-- ur5 arguments -->
  <arg name="ur5_left_prefix" default="left_arm_" />
  <arg name="ur5_right_prefix" default="right_arm_" />
  <arg name="ur5_left_ip" default="192.168.1.50"/>
  <arg name="ur5_right_ip" default="192.168.1.60"/>
  <arg name="ur5_left_reverse_port" default="33829"/>
  <arg name="ur5_right_reverse_port" default="50001"/>
  <arg name="ur5_min_payload"  default="0.0"/>
  <arg name="ur5_max_payload"  default="3.0"/>
  <arg name="ur5_max_velocity" default="5.0"/> 
  <!-- <arg name="ur5_servoj_time" default="0.008"/> -->
  <arg name="ur5_left_base_frame" default="$(arg ur5_left_prefix)base"/>
  <arg name="ur5_right_base_frame" default="$(arg ur5_right_prefix)base"/>
  <arg name="ur5_left_tool_frame" default="$(arg ur5_left_prefix)tool0_controller"/>
  <arg name="ur5_right_tool_frame" default="$(arg ur5_right_prefix)tool0_controller"/>
  <arg name="ur5_shutdown_on_disconnect" default="true" />

  <!-- robotiq 3 finger grippers arguments -->
  <arg name="robotiq_left_ip" default="192.168.1.12"/>
  <arg name="robotiq_right_ip" default="192.168.1.13"/>
  <arg name="robotiq_left_prefix" default="left_gripper_"/>
  <arg name="robotiq_right_prefix" default="right_gripper_"/>

  
  <!-- <include file="$(find bulldog_robot_moveit_config_rs)/launch/planning_context.launch">
    <arg name="load_robot_description" value="true"/>
  </include> -->

  <!-- ur5 hardware interfaces -->
  <group ns="left_arm">
    <node name="ur5_hardware_interface" pkg="ur_modern_driver" type="ur_driver" output="screen" launch-prefix="$(arg launch_prefix)">
      <param name="robot_ip_address" type="str" value="$(arg ur5_left_ip)" />
      <param name="reverse_port" value="$(arg ur5_left_reverse_port)"/>
      <param name="min_payload" type="double" value="$(arg ur5_min_payload)" />
      <param name="max_payload" type="double" value="$(arg ur5_max_payload)" />
      <param name="max_velocity" type="double" value="$(arg ur5_max_velocity)" />
      <param name="use_ros_control" type="bool" value="True"/>
      <param name="servoj_gain" type="double" value="750" />
      <!-- <param name="servoj_time" type="double" value="$(arg servoj_time)" /> -->
      <param name="prefix" type="str" value="$(arg ur5_left_prefix)" />
      <param name="base_frame" type="str" value="$(arg ur5_left_base_frame)"/>
      <param name="tool_frame" type="str" value="$(arg ur5_left_tool_frame)"/>
      <param name="shutdown_on_disconnect" type="bool" value="$(arg ur5_shutdown_on_disconnect)"/>
    </node>
  </group>

  <group ns="right_arm">
    <node name="ur5_hardware_interface" pkg="ur_modern_driver" type="ur_driver" output="screen" launch-prefix="$(arg launch_prefix)">
      <param name="robot_ip_address" type="str" value="$(arg ur5_right_ip)" />
      <param name="reverse_port" value="$(arg ur5_right_reverse_port)"/>
      <param name="min_payload" type="double" value="$(arg ur5_min_payload)" />
      <param name="max_payload" type="double" value="$(arg ur5_max_payload)" />
      <param name="max_velocity" type="double" value="$(arg ur5_max_velocity)" />
      <param name="use_ros_control" type="bool" value="True"/>
      <param name="servoj_gain" type="double" value="750" />
      <!-- <param name="servoj_time" type="double" value="$(arg servoj_time)" /> -->
      <param name="prefix" type="str" value="$(arg ur5_right_prefix)" />
      <param name="base_frame" type="str" value="$(arg ur5_right_base_frame)"/>
      <param name="tool_frame" type="str" value="$(arg ur5_right_tool_frame)"/>
      <param name="shutdown_on_disconnect" type="bool" value="$(arg ur5_shutdown_on_disconnect)"/>
    </node>
  </group>

  <!-- robotiq 3 finger gripper hardware interfaces -->
  <group ns="left_gripper">
    <node name="robotiq_3f_gripper_hardware_interface" pkg="robotiq_3f_gripper_control" type="Robotiq3FGripperTcpNode.py" 
      args="$(arg robotiq_left_ip)"/>

    <node name="robotiq_3f_gripper_joint_state_publisher" pkg="robotiq_3f_gripper_joint_state_publisher" type="robotiq_3f_gripper_joint_states">
      <param name="prefix" type="str" value="$(arg robotiq_left_prefix)"/>
      <!-- <remap from="Robotiq3FGripperRobotInput" to="left_hand/Robotiq3FGripperRobotInput"/> -->
      <!-- <remap from="joint_states" to="left_gripper/joint_states"/> -->
    </node>
  </group>

  <group ns="right_gripper">
    <node name="robotiq_3f_gripper_hardware_interface" pkg="robotiq_3f_gripper_control" type="Robotiq3FGripperTcpNode.py"
      args="$(arg robotiq_right_ip)"/>

    <node name="robotiq_3f_gripper_joint_state_publisher" pkg="robotiq_3f_gripper_joint_state_publisher" type="robotiq_3f_gripper_joint_states">
      <param name="prefix" type="str" value="$(arg robotiq_right_prefix)"/>
      <!-- <remap from="Robotiq3FGripperRobotInput" to="right_hand/Robotiq3FGripperRobotInput" /> -->
      <!-- <remap from="joint_states" to="right_gripper/joint_states" /> -->
    </node>
  </group>

  <!-- broadcast static tf for virtual robot root -->
  <node pkg="tf" type="static_transform_publisher" name="virtual_joint_broadcaster_0" args="0 0 0 0 0 0 odom base_link 100" />

  <!-- startup MoveIt move group context -->
  <include file="$(find bulldog_robot_moveit_config_rs)/launch/move_group.launch">
    <arg name="allow_trajectory_execution" value="true"/>
    <arg name="fake_execution" value="false"/>
    <arg name="info" value="true"/>
    <arg name="debug" value="$(arg debug)"/>
  </include>

  <!-- startup rviz -->
  <include file="$(find bulldog_robot_moveit_config_rs)/launch/moveit_rviz.launch">
    <arg name="config" value="true"/>
    <arg name="debug" value="$(arg debug)"/>
  </include>

</launch>
